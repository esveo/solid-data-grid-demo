import{r as fe,a as ve,b as ye,c as he,d as ge,e as se,f as d,g as N,i as g,h as f,j as b,F,t as B,k as _e,l as R,u as le,S as J,m as ue,D as X,n as M,o as D,p as $e,q as Ce,s as pe,v as Se,w as Y,x as xe,y as Be,z as be}from"./vendor.322caa40.js";const Ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};Ie();async function we(e){let t=performance.now();for(;;){const n=e.next();if(n.done)return n.value;performance.now()-t>10&&(await Ne(),t=performance.now())}}const ze=window.requestIdleCallback??requestAnimationFrame;function Ne(){return new Promise(e=>{ze(()=>{e()})})}function Ae(e){return{id:e,name:fe(),income:ve({min:2e4,max:2e6}),dateOfBirth:ye({from:new Date("1950-01-01"),to:new Date}),favoriteTeam:he(),country:ge()}}async function De(e){return we(Fe(e))}function*Fe(e){const t=[],o=Math.ceil(e/100);for(let r=0;r<o;r++){const s=r===o-1?Math.min(100,e%100||100):100;for(let u=0;u<s;u++){const l=r*100+u;t.push(Ae(l))}yield}return t}const Oe=B('<div><h1>Solid data grid <small>(no touch support for now)</small></h1><label>Select data: <select value="100_10"></select></label> <label>Pinned cols: <select></select></label> <label>Groups: <select></select></label> <label>Sorting: <select></select></label> <label>Country filter: <select><optgroup><option>All Countries</option></optgroup><optgroup></optgroup></select></label></div>'),Ee=B("<option> rows - <!> columns</option>"),V=B("<option></option>"),Ge=B("<option> </option>");function ke(e){const t=[{rows:100,columns:10},{rows:1e3,columns:100},{rows:1e4,columns:100},{rows:1e5,columns:100}],n=[1,2,3],o=[[],["Country"],["Country","Age group"]],r=[{key:"Title",direction:"ASC"},{key:"Title",direction:"DESC"},{key:"Income",direction:"ASC"},{key:"Income",direction:"DESC"}],[i,s]=se({persons:null,dataOption:{...t[0]},pinnedColumns:1,countryFilter:null,groupBy:o[0],sortBy:r[0]}),u=d(()=>[...new Set(i.persons?.map(l=>l.country))].sort());return N(()=>{De(i.dataOption.rows).then(l=>{s(_e({...i,persons:l}))})}),N(()=>{const l=i.dataOption.columns;R(()=>{for(let m=0;m<l;m++)e().moveColumn("Dummy column "+m,"UNFROZEN")})}),N(()=>{const l=i.pinnedColumns;R(()=>{const m=e().derivations.columns().slice(0,l),h=e().derivations.columns().slice(l,-l),a=e().derivations.columns().slice(-l);for(const _ of m)e().moveColumn(_.key,"LEFT");for(const _ of h)e().moveColumn(_.key,"UNFROZEN");for(const _ of a)e().moveColumn(_.key,"RIGHT")})}),N(()=>{const l=i.groupBy,m=le(e().derivations.groupByColumns);R(()=>{for(const h of m)e().removeFromGroups(h.key);for(const h of l)e().groupBy(h)})}),N(()=>{e().sortByColumn(i.sortBy.key,i.sortBy.direction)}),N(()=>{e().setFilter("Country",i.countryFilter?[i.countryFilter]:null)}),{store:i,updateStore:s,dataOptions:t,countries:u,pinningOptions:n,groupingOptions:o,sortBy:r}}function Pe(e){return(()=>{const t=Oe.cloneNode(!0),n=t.firstChild,o=n.nextSibling,r=o.firstChild,i=r.nextSibling,s=o.nextSibling,u=s.nextSibling,l=u.firstChild,m=l.nextSibling,h=u.nextSibling,a=h.nextSibling,_=a.firstChild,C=_.nextSibling,p=a.nextSibling,$=p.nextSibling,x=$.firstChild,z=x.nextSibling,O=$.nextSibling,y=O.nextSibling,S=y.firstChild,w=S.nextSibling,G=w.firstChild,T=G.nextSibling;return t.style.setProperty("flex","0 0 auto"),t.style.setProperty("margin-bottom","1rem"),i.addEventListener("change",c=>{const v=e.controls.dataOptions.find(I=>[I.rows,I.columns].join("_")===c.currentTarget.value);e.controls.updateStore("dataOption",{...v})}),g(i,f(F,{get each(){return e.controls.dataOptions},children:c=>(()=>{const v=Ee.cloneNode(!0),I=v.firstChild,A=I.nextSibling;return A.nextSibling,g(v,()=>Intl.NumberFormat(void 0,{useGrouping:!0}).format(c.rows),I),g(v,()=>c.columns,A),b(()=>v.value=[c.rows,c.columns].join("_")),v})()})),m.addEventListener("change",c=>e.controls.updateStore("pinnedColumns",Number(c.currentTarget.value))),g(m,f(F,{get each(){return e.controls.pinningOptions},children:c=>(()=>{const v=V.cloneNode(!0);return v.value=c,g(v,c),v})()})),C.addEventListener("change",c=>e.controls.updateStore("groupBy",c.currentTarget.value.split("-"))),g(C,f(F,{get each(){return e.controls.groupingOptions},children:c=>(()=>{const v=V.cloneNode(!0);return g(v,()=>c.join(" > ")||"No groups"),b(()=>v.value=c.join("-")),v})()})),z.addEventListener("change",c=>e.controls.updateStore("sortBy",JSON.parse(c.currentTarget.value))),g(z,f(F,{get each(){return e.controls.sortBy},children:c=>(()=>{const v=Ge.cloneNode(!0),I=v.firstChild;return g(v,()=>c.key,I),g(v,()=>c.direction,null),b(()=>v.value=JSON.stringify(c)),v})()})),w.addEventListener("change",c=>e.controls.updateStore("countryFilter",c.currentTarget.value||null)),g(T,f(F,{get each(){return e.controls.countries()},children:c=>(()=>{const v=V.cloneNode(!0);return v.value=c,g(v,c),v})()})),b(c=>{const v=e.controls.store.pinnedColumns,I=e.controls.store.groupBy.join("-"),A=JSON.stringify(e.controls.store.sortBy),k=e.controls.store.countryFilter??"";return v!==c._v$&&(m.value=c._v$=v),I!==c._v$2&&(C.value=c._v$2=I),A!==c._v$3&&(z.value=c._v$3=A),k!==c._v$4&&(w.value=c._v$4=k),c},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t})()}function E(e){return function(...n){return n.filter(o=>typeof o=="string").map(o=>`${e}${o}`).join(" ")}}const j="solid-data-grid",Ke=B("<div><span> </span></div>");function Z(e){return(()=>{const t=Ke.cloneNode(!0),n=t.firstChild,o=n.firstChild;return g(n,()=>e.content?.toLocaleString(void 0,{minimumFractionDigits:e.decimals,maximumFractionDigits:e.decimals}),o),g(n,()=>e.suffix,null),b(r=>{const i=te("__number-renderer"),s=te("__number-renderer--content");return i!==r._v$&&(t.className=r._v$=i),s!==r._v$2&&(n.className=r._v$2=s),r},{_v$:void 0,_v$2:void 0}),t})()}const te=E(j);function Te(e,t){const n=[];for(let o=e;o<t;o++)n.push(o);return n}function L(e){return e[e.length-1]}function Re(e,t){const n={};return e.forEach((o,r,i)=>{n[t(o,r,i)]=o}),n}function Le(e,t){const n={};for(const[o,r]of Object.entries(e))n[o]=t(r,o,e);return n}function We(e,t){const n={};for(const o of e){const r=t(o),i=Array.isArray(r)?r:[r];for(const s of i){const u=String(s??"---");n[u]||(n[u]=[]),n[u].push(o)}}return n}function Q(e,t=", "){return Array.isArray(e)?e.join(t):e}function Me(e){return Array.isArray(e)?e:[e]}function je(e,t){let n=0;for(const o of e)n+=t(o);return n/e.length}const He=B("<div><span></span></div>");function Ve(e){return(()=>{const t=He.cloneNode(!0),n=t.firstChild;return g(n,()=>e.content),b(o=>{const r=ne("__string-renderer"),i=ne("__string-renderer--content");return r!==o._v$&&(t.className=o._v$=r),i!==o._v$2&&(n.className=o._v$2=i),o},{_v$:void 0,_v$2:void 0}),t})()}const ne=E(j);function H(e){return f(J,{get when(){return typeof e.content=="number"},get fallback(){return f(Ve,{get content(){return e.content}})},get children(){return f(Z,{get content(){return e.content}})}})}const Ue=B("<div><button></button><span> (<!>)</span></div>"),Ze=B("<div></div>");function qe(e){const t=()=>e.context().input.showAllRow?.()?0:-1,n=d(()=>e.node.path.length),o=()=>e.context().state.groupByColumnKeys[n()-1],r=()=>e.context().derivations.columnByKey()[o()??""],i=()=>e.context().isGroupExpanded(e.node);return(()=>{const s=Ue.cloneNode(!0),u=s.firstChild,l=u.nextSibling,m=l.firstChild,h=m.nextSibling;return h.nextSibling,u.$$click=()=>e.context().toggleGroupExpansion(e.node),g(u,()=>i()?"V":">"),g(s,f(J,{get when(){return r()},get fallback(){return f(H,{content:"All"})},get children(){return f(X,{get component(){return r().Item},get context(){return e.context},get node(){return{item:e.node.items()[0],path:[],pathKey:"",type:"ITEM_NODE"}},get template(){return r()}})}}),l),g(l,()=>e.node.items().length,h),b(a=>{const _=q("__title-renderer"),C=n()+t(),p=q("__title-renderer-expansion-toggle");return _!==a._v$&&(s.className=a._v$=_),C!==a._v$2&&s.style.setProperty("--level",a._v$2=C),p!==a._v$3&&(u.className=a._v$3=p),a},{_v$:void 0,_v$2:void 0,_v$3:void 0}),s})()}function Je(e){const t=()=>e.context().input.showAllRow?.()?0:-1,n=d(()=>{const o=e.node.path.length;return o+1+(o>0?2:0)});return(()=>{const o=Ze.cloneNode(!0);return g(o,f(H,{get content(){return e.content??Q(e.template.valueFromItem({...e,item:e.node.item}))}})),b(r=>{const i=q("__title-renderer"),s=n()+t();return i!==r._v$4&&(o.className=r._v$4=i),s!==r._v$5&&o.style.setProperty("--level",r._v$5=s),r},{_v$4:void 0,_v$5:void 0}),o})()}const q=E(j);function Xe(e){return{key:"Title",valueFromItem:t=>e(t.item),valueFromGroup:t=>L(t.node.path)??"All",Item:Je,Group:qe,frozen:"LEFT",columnWidth:300}}ue(["click"]);function Ye(e,t){const n=e.valueFromGroup??(e.aggregateItems?r=>r.node.aggregationsByColumnKey()[e.key]():void 0);return{...e,title:e.title??e.key,columnWidth:e.columnWidth??200,resizable:e.resizable??!0,Item:e.Item??et,Group:e.Group??tt,groupable:e.groupable??!1,frozen:e.frozen??"UNFROZEN",sortBy:e.sortBy??e.valueFromItem,sortable:e.sortable??!0,sortGroupBy:e.sortGroupBy??n,valueFromGroup:n}}function Qe(e,t){return d(M(e,t))}function et(e){return f(H,{get content(){return Q(e.template.valueFromItem({...e,item:e.node.item}))}})}function tt(e){return f(H,{get content(){return Q(e.template.valueFromGroup?.(e))}})}function nt(e){return{renderFilter:()=>null,parseFilterState:t=>new Set(t),doesItemMatchFilter:t=>{const n=e??t.template.valueFromItem;return Me(n(t)).some(r=>t.state.has(r))}}}function rt(e){return Object.keys(e)}function ce(e){throw console.error("Should never be called, but was called with:",e),new Error("Should never be called")}function ot(e){return!!e}function ae(e){const[t,n]=D({width:0,height:0});return N(()=>{const o=e();if(!o)return;const r=new ResizeObserver(i=>{const[s]=i,{width:u,height:l}=s.contentRect;n({width:Math.floor(u),height:Math.floor(l)})});r.observe(o),$e(()=>{r.unobserve(o),r.disconnect()})}),t}function it(e){if(e.items.length===0)return[];const t=Math.floor(e.startOfVisibleArea),n=Math.ceil(e.sizeOfVisibleArea),o=t+n;let r=0,i=0;for(;i<e.items.length;i++){const l=e.items[i],m=e.getItemDimensionRange(l);if(m.start+m.size>t){r=i;break}}let s=e.items.length-1;for(;i<e.items.length;i++){const l=e.items[i];if(e.getItemDimensionRange(l).start>o){s=i-1;break}}const u=[];for(let l=r;l<=s;l++)u.push(e.items[l]);return u}function re(e){const t=()=>e.frozenCountAtStart()??0,n=()=>e.indexedItems().length-(e.frozenCountAtEnd()??0)-1,o=d(()=>{if(!e.frozenCountAtStart()||!e.indexedItems().length)return 0;const a=e.itemDimensions()[0]?.start??0;return(e.itemDimensions()[e.frozenCountAtStart()-1]?.end??0)-a}),r=d(()=>{if(!e.frozenCountAtEnd()||!e.indexedItems().length)return 0;const a=e.itemDimensions()[n()+1]?.start??0;return(e.itemDimensions()[e.indexedItems().length-1]?.end??0)-a}),i=()=>e.availableSize()-o()-r(),s=d(()=>{if(!e.indexedItems().length)return 0;const a=e.itemDimensions()[t()]?.start??0;return(e.itemDimensions()[n()]?.end??0)-a}),u=d(()=>e.indexedItems().slice(0,t())),l=d(()=>e.indexedItems().slice(t(),n()+1)),m=d(()=>e.indexedItems().slice(n()+1)),h=d(()=>it({getItemDimensionRange:a=>e.itemDimensions()[a.index()]??{start:0,end:0,size:0},items:l(),sizeOfVisibleArea:i(),startOfVisibleArea:e.scrollPosition()+o()}));return{firstFrozen:{indexedItems:u,visibleIndexedItems:u,areaSize:o,totalItemSize:o,positionOffset:()=>0,scrollPosition:()=>0},unfrozen:{areaSize:i,totalItemSize:s,indexedItems:l,visibleIndexedItems:h,positionOffset:o,scrollPosition:e.scrollPosition},secondFrozen:{indexedItems:m,visibleIndexedItems:m,areaSize:r,totalItemSize:r,positionOffset:()=>o()+s(),scrollPosition:()=>0}}}const de="solid-virtualized-grid";function oe(e,t){return e.map(n=>({size:t(n),start:0,end:0})).map(st)}function st(e,t,n){const o=n[t-1]??{size:0,start:0};return e.start=o.start+o.size,e.end=e.start+e.size,e}const lt=B("<div><div></div></div>");function ut(e){let t;return N(()=>{t.scrollTop=e.vertical.scrollPosition(),t.scrollLeft=e.horizontal.scrollPosition()}),(()=>{const n=lt.cloneNode(!0),o=n.firstChild,r=t;return typeof r=="function"?r(n):t=n,g(n,f(F,{get each(){return e.vertical.visibleIndexedItems()},children:i=>f(F,{get each(){return e.horizontal.visibleIndexedItems()},children:s=>{const u=()=>e.columnDimensions[s.index()],l=()=>e.rowDimensions[i.index()];return e.cell({columnIndex:s.index,rowIndex:i.index,column:s.item,row:i.item,style:()=>({position:"absolute",left:u().start-e.horizontal.positionOffset()+"px",top:l().start-e.vertical.positionOffset()+"px",width:u().size+"px",height:l().size+"px"})})}})}),o),b(i=>{const s=ct("__grid-area"),u=e.horizontal.areaSize()+"px",l=e.vertical.areaSize()+"px",m=e.horizontal.totalItemSize+"px",h=e.vertical.totalItemSize+"px";return s!==i._v$&&(n.className=i._v$=s),u!==i._v$2&&n.style.setProperty("width",i._v$2=u),l!==i._v$3&&n.style.setProperty("height",i._v$3=l),m!==i._v$4&&o.style.setProperty("width",i._v$4=m),h!==i._v$5&&o.style.setProperty("height",i._v$5=h),i},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),n})()}const ct=E(de);function ie(e){return M(e,(t,n)=>({item:t,index:n}))}const at=B("<div><div></div><div><div></div></div></div>");function dt(e){const[t,n]=D(0),[o,r]=D(0);let i;const s=ae(()=>i),u=d(ie(()=>e.columns)),l=d(ie(()=>e.rows)),m=d(()=>oe(e.columns,e.getColumnWidth)),h=d(()=>oe(e.rows,e.getRowHeight)),a=re({availableSize:()=>s().width,indexedItems:u,itemDimensions:m,frozenCountAtStart:()=>e.frozenAreas?.left,frozenCountAtEnd:()=>e.frozenAreas?.right,scrollPosition:t}),_=re({availableSize:()=>s().height,indexedItems:l,itemDimensions:h,frozenCountAtStart:()=>e.frozenAreas?.top,frozenCountAtEnd:()=>e.frozenAreas?.bottom,scrollPosition:o}),C=Object.values(_).flatMap(p=>Object.values(a).map($=>f(ut,{get cell(){return e.cell},get columnDimensions(){return m()},get rowDimensions(){return h()},horizontal:$,vertical:p})));return(()=>{const p=at.cloneNode(!0),$=p.firstChild,x=$.nextSibling,z=x.firstChild;$.addEventListener("wheel",y=>{y.preventDefault(),i.scrollTop+=y.deltaY,i.scrollLeft+=y.deltaX}),$.style.setProperty("position","absolute"),g($,C),x.addEventListener("scroll",y=>{R(()=>{r(y.target.scrollTop),n(y.target.scrollLeft)})});const O=i;return typeof O=="function"?O(x):i=x,b(y=>{const S=U("__grid-container"),w=e.width+"px",G=e.height+"px",T=U("__cell-area-container"),c=s().width+"px",v=s().height+"px",I=U("__scroll-bar-dummy"),A=(L(m())?.end??0)+"px",k=(L(h())?.end??0)+"px";return S!==y._v$&&(p.className=y._v$=S),w!==y._v$2&&p.style.setProperty("width",y._v$2=w),G!==y._v$3&&p.style.setProperty("height",y._v$3=G),T!==y._v$4&&($.className=y._v$4=T),c!==y._v$5&&$.style.setProperty("width",y._v$5=c),v!==y._v$6&&$.style.setProperty("height",y._v$6=v),I!==y._v$7&&(x.className=y._v$7=I),A!==y._v$8&&z.style.setProperty("width",y._v$8=A),k!==y._v$9&&z.style.setProperty("height",y._v$9=k),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0}),p})()}const U=E(de);function mt(e){return t(e.items,e.groupByColumns,[]);function t(n,o,r){const i=d(()=>o()[0]),s=d(()=>vt({sortByState:e.sortBy(),columnToGroupNodesBy:i()})),u=d(()=>i()?.valueFromItem),l=d(()=>o().slice(1)),m=d(()=>!!i()),h=d(()=>m()?We(n(),$=>u()({context:e.context,item:$,template:i()})):null),a=d(()=>{const $=h();return $?Object.keys($):null}),_=d(()=>{if(!m())return n().map(S=>({type:"ITEM_NODE",item:S,path:r,pathKey:W(r)}));const x=a().map(S=>{const w=d(()=>h()[S]);return t(w,l,[...r,S])()}),{sortDirectionFactor:z,sortingFunction:O}=s();return x.map(S=>({node:S,sortingCriteria:O?.({context:e.context,template:i(),node:S})})).sort((S,w)=>S.sortingCriteria<w.sortingCriteria?-1*z:w.sortingCriteria<S.sortingCriteria?1*z:0).map(S=>S.node)}),C=M(e.columnsWithAggregations,$=>({column:$,aggregation:d(()=>$.aggregateItems(n()))})),p=d(()=>{const $={};for(const x of C())$[x.column.key]=x.aggregation;return $});return d(()=>({type:"GROUP_NODE",path:r,pathKey:W(r),items:n,childNodes:_,aggregationsByColumnKey:p}))}}function ft(e,t,n){return d(()=>r(e(),[],t(),n?.()));function r(i,s,u,l){if(l&&s.push(i),!(!l||i.pathKey in u))return s;if(i.type==="GROUP_NODE")for(const h of i.childNodes())r(h,s,u,!0);return s}}function W(e){return e.join("//")}function vt(e){const t=e.sortByState?.column.valueFromGroup,n=e.columnToGroupNodesBy===e.sortByState?.column||t?e.sortByState?.column.sortGroupBy:void 0,o=e.columnToGroupNodesBy?.sortGroupBy,r=n??o??yt,i=n&&e.sortByState?.direction==="DESC"?-1:1;return{sortingFunction:r,sortDirectionFactor:i}}function yt(e){return L(e.node.path)??""}class ht{constructor(t){this.input=t;const[n,o]=this.buildStore();this.state=n,this.updateStore=r=>o(Ce(r)),this.derivations=this.deriveData(),this.initState()}initState(){const t=this.derivations.columns();this.updateStore(n=>{for(const o of t)n.columnKeysByArea[o.frozen].push(o.key)})}buildStore(){const t=this.input.initialState,n={columnKeysByArea:{LEFT:[],RIGHT:[],UNFROZEN:[]},columnWidthByColumnKey:{},filterStateByColumnKey:{},sortBy:null,groupByColumnKeys:[],expandedPaths:{}};return Object.assign(n,t),se(n)}deriveData(){function t(){}return t.columns=d(M(this.input.columnDefinitions,n=>Ye(n))),t.columnByKey=d(()=>Re(t.columns(),n=>n.key)),t.columnsByArea=d(()=>{const n=t.columnByKey();return Le(this.state.columnKeysByArea,o=>o.map(r=>n[r]))}),t.columnsWidthAggregations=d(()=>t.columns().filter(n=>n.aggregateItems)),t.getColumnWidth=n=>this.state.columnWidthByColumnKey[n]??this.derivations.columnByKey()[n]?.columnWidth??200,t.sortBy=d(()=>{const n=this.state.sortBy;if(!n)return;const o=t.columnByKey()[n.columnKey];if(!!o)return{column:o,direction:n.direction}}),t.activeFilters=d(()=>{const n=this.state.filterStateByColumnKey,o=t.columnByKey();return Object.keys(n).map(i=>{const s=o[i];if(!s||!s.filter)return null;const u=n[i],l=s.filter.parseFilterState??(m=>m);return{template:s,filterState:u,parsedFilterState:l(u)}}).filter(ot).filter(i=>!!i.template)}),t.filteredItems=d(()=>{const n=t.activeFilters();return n.length===0?this.input.items():this.input.items().filter(o=>n.every(r=>r.template.filter?.doesItemMatchFilter({item:o,state:r.parsedFilterState,context:()=>this,template:r.template})))}),t.sortedItems=d(()=>{const n=t.sortBy();if(!n)return t.filteredItems();const o=n.column.sortBy,r=n.direction==="ASC"?-1:1;return t.filteredItems().map(s=>({sortCriteria:o({item:s,context:()=>this,template:n.column}),item:s})).sort((s,u)=>s.sortCriteria<u.sortCriteria?r:s.sortCriteria>u.sortCriteria?r*-1:0).map(s=>s.item)}),t.groupByColumns=d(()=>{const n=t.columnByKey();return this.state.groupByColumnKeys.map(o=>n[o]).filter(o=>!!o?.groupable)}),t.itemTree=mt({context:()=>this,groupByColumns:t.groupByColumns,sortBy:t.sortBy,items:t.sortedItems,columnsWithAggregations:t.columnsWidthAggregations}),t.flatTree=ft(t.itemTree,()=>this.state.expandedPaths,this.input.showAllRow),t}resizeColumn(t,n){const o=Math.max(n,60);this.updateStore(r=>{r.columnWidthByColumnKey[t.key]=o})}sortByColumn(t,n="ASC"){const o=this.derivations.columnByKey()[t];this.updateStore(r=>{if(!o){r.sortBy=null;return}r.sortBy||(r.sortBy={columnKey:t,direction:n}),r.sortBy.columnKey=t,r.sortBy.direction=n})}moveColumn(t,n,o){this.updateStore(r=>{for(const u of rt(r.columnKeysByArea))r.columnKeysByArea[u]=r.columnKeysByArea[u].filter(l=>l!==t);const i=r.columnKeysByArea[n];let s=o?i.indexOf(o):-1;s===-1&&(s=i.length),i.splice(s,0,t)})}groupBy(t,n){this.updateStore(o=>{o.groupByColumnKeys=o.groupByColumnKeys.filter(i=>i!==t);let r=n?o.groupByColumnKeys.indexOf(n):-1;r===-1&&(r=o.groupByColumnKeys.length),o.groupByColumnKeys.splice(r,0,t)})}setFilter(t,n){this.updateStore(o=>{n===null?delete o.filterStateByColumnKey[t]:o.filterStateByColumnKey[t]=n})}removeFromGroups(t){this.updateStore(n=>{n.groupByColumnKeys=n.groupByColumnKeys.filter(o=>o!==t)})}toggleGroupExpansion(t){const n=W(t.path);this.updateStore(o=>{n in o.expandedPaths?delete o.expandedPaths[n]:o.expandedPaths[n]=!0})}isGroupExpanded(t){return W(t.path)in this.state.expandedPaths}}const me=pe();function gt(e){return f(me.Provider,{get value(){return e.value},get children(){return e.children}})}function K(){const e=Se(me);if(!e)throw new Error("No datagrid provider found");return e}const ee=B("<div></div>"),_t=B("<div><span></span></div>");function $t(e){switch(e.row.type){case"HEADER_ROW":return f(Ct,e);case"ITEM_NODE":return f(pt,e);case"GROUP_NODE":return f(St,e);default:ce(e.row)}}function Ct(e){const t=K(),n=()=>t.derivations.getColumnWidth(e.column.key),[o,r]=D(),[i,s]=D(),u=()=>{const a=o(),_=i();return!a||!_?0:_.x-a.x};function l(a){a.preventDefault(),r({x:a.clientX,initialColumnWidth:n()}),document.addEventListener("pointermove",m),document.addEventListener("pointerup",h)}function m(a){s({x:a.clientX});const _=(o()?.initialColumnWidth??0)+u();t.resizeColumn(e.column,_)}function h(a){r(void 0),s(void 0),document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",h)}return(()=>{const a=_t.cloneNode(!0),_=a.firstChild;return g(a,f(J,{get when(){return e.column.resizable},get children(){const C=ee.cloneNode(!0);return C.$$pointerdown=l,b(()=>C.className=P("__header-cell-resize-handle")),C}}),_),g(_,()=>e.column.title),b(C=>{const p=P("__cell","__header-cell"),$=e.style(),x=P("__header-cell--title");return p!==C._v$&&(a.className=C._v$=p),C._v$2=Y(a,$,C._v$2),x!==C._v$3&&(_.className=C._v$3=x),C},{_v$:void 0,_v$2:void 0,_v$3:void 0}),a})()}function pt(e){const t=K();return(()=>{const n=ee.cloneNode(!0);return g(n,f(X,{get component(){return e.column.Item},get node(){return e.row},get template(){return e.column},context:()=>t})),b(o=>{const r=e.style(),i=P("__cell","__body-cell","__item-cell");return o._v$4=Y(n,r,o._v$4),i!==o._v$5&&(n.className=o._v$5=i),o},{_v$4:void 0,_v$5:void 0}),n})()}function St(e){const t=K();return(()=>{const n=ee.cloneNode(!0);return g(n,f(X,{get component(){return e.column.Group},get node(){return e.row},get template(){return e.column},context:()=>t})),b(o=>{const r=e.style(),i=P("__cell","__body-cell","__group-cell");return o._v$6=Y(n,r,o._v$6),i!==o._v$7&&(n.className=o._v$7=i),o},{_v$6:void 0,_v$7:void 0}),n})()}const P=E(j);ue(["pointerdown"]);D(200);function xt(e){const t=K(),n={type:"HEADER_ROW"},o=d(()=>[n,...t.derivations.flatTree()]),r=t.derivations.columnsByArea;return f(dt,{get rows(){return o()},get columns(){return[...t.derivations.columnsByArea().LEFT,...t.derivations.columnsByArea().UNFROZEN,...t.derivations.columnsByArea().RIGHT].filter(Boolean)},getColumnWidth:i=>t.derivations.getColumnWidth(i.key),getRowHeight:i=>{switch(i.type){case"HEADER_ROW":return t.input.headerHeight??50;case"ITEM_NODE":return t.input.itemRowHeight??30;case"GROUP_NODE":return t.input.groupRowHeight??30;default:ce(i)}},get frozenAreas(){return{top:1,left:r().LEFT.length,right:r().RIGHT.length}},get height(){return e.height},get width(){return e.width},cell:i=>f($t,i)})}function Bt(){return{buildColumns(e){return()=>e.flatMap(t=>typeof t=="function"?t():t)},buildContext(e){return new ht(e)},useContext(){return K()}}}const bt=B("<div></div>");function It(e){const[t,n]=D(),[o,r]=D(),i=ae(o);return N(()=>{const s=t();r(s?.parentElement??void 0)}),[xe(()=>le(()=>e.children(i))),(()=>{const s=bt.cloneNode(!0);return n(s),s})()]}const wt=B("<button>\u{1F4BE}</button>"),zt=B("<div><div></div></div>");Be("THIS IS MY SEED!");function Nt(){const e=ke(()=>o),t=Bt(),n=t.buildColumns([{...Xe(r=>r.name),key:"Title"},{key:"Income",valueFromItem:r=>r.item.income,Item:r=>f(Z,{get content(){return r.node.item.income},decimals:0}),Group:r=>f(Z,{get content(){return r.node.aggregationsByColumnKey().Income()},decimals:0,suffix:"$"}),aggregateItems:r=>je(r,i=>i.income),columnWidth:200},{key:"Country",valueFromItem:r=>r.item.country,filter:nt(),groupable:!0},Qe(()=>Te(0,e.store.dataOption.columns),r=>({key:"Dummy column "+r,valueFromItem:i=>i.template.key})),{key:"Date of Birth",valueFromItem:r=>r.item.dateOfBirth.toLocaleDateString(),sortBy:r=>r.item.dateOfBirth},{key:"Age group",valueFromItem:r=>r.item.dateOfBirth.getFullYear()>1992?"Preeetty old":"Quite young",groupable:!0},{key:"actions",title:"",valueFromItem:()=>null,Item:r=>wt.cloneNode(!0),columnWidth:60,resizable:!1,frozen:"RIGHT"}]),o=t.buildContext({columnDefinitions:n,gridKey:"person-grid",items:()=>e.store.persons??[],initialState:{groupByColumnKeys:["Country","Age group"]},showAllRow:()=>!1});return f(gt,{value:o,get children(){const r=zt.cloneNode(!0),i=r.firstChild;return r.style.setProperty("height","100%"),r.style.setProperty("display","flex"),r.style.setProperty("flex-direction","column"),r.style.setProperty("overflow","hidden"),g(r,f(Pe,{controls:e}),i),i.style.setProperty("flex","1 1 auto"),i.style.setProperty("overflow","hidden"),g(i,f(It,{children:s=>f(xt,{get width(){return s().width},get height(){return s().height}})})),r}})}be(()=>f(Nt,{}),document.getElementById("root"));
